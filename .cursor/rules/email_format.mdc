---
description: 
globs: 
alwaysApply: true
---
# .cursor/rules/email_format.md

## ğŸ“¬ Formatregel: Wetterberichte per E-Mail (fÃ¼r InReach, max. 160 Zeichen)

Diese Regel beschreibt den exakten Aufbau der Wetterberichte in den drei Betriebsmodi: **Morgenbericht (z.B. 04:30)**, **Abendbericht (z.B. 19:00)** und **Zwischenbericht (dynamisch bei RisikoÃ¤nderung)**.

### Technische Vorgaben

- MaximallÃ¤nge: 160 Zeichen
- Zeichensatz: Nur ASCII (keine Emojis, Links, Sonderzeichen)
- Zeitformat: Alle Uhrzeiten lokal (CEST)
- Quelle: meteofrance-api, Fallback: open-meteo
- Schwellenwerte: Aus `config.yaml`
- Etappen: Bestimmung Ã¼ber `etappen.json` basierend auf Datum
- der Versand wird Ã¼ber crontab geregelt und ist nicht Teil des Programmcodes. Es muss lediglich sichergestellt werden, dass es die drei unterschiedlichen Formate gibt und dass diese per "--befehl" gesteuert werden kÃ¶nnen

---

## ğŸ•“ Morgenbericht (z.B. 04:30 Uhr)

### Inhalt
- Gilt fÃ¼r den aktuellen Tag
- Zeitraum: 05:00â€“17:00 CEST
- Geopunkte: alle Punkte der heutigen Etappe
- Aggregierung: Maximalwerte Ã¼ber Zeit und Geopunkte

### Format
{EtappeHeute} | Gewitter {g1}%@{t1} {g2}%@{t2} | Gewitter +1 {g1_next}% | Regen {r1}%@{t3} {r2}%@{t4} {regen_mm}mm | Hitze {temp_max}Â°C | Wind {wind_max}km/h | {vigilance_warning}

### ErlÃ¤uterung
- {g1}@{t1}: HÃ¶chste Gewitterwahrscheinlichkeit
- {g2}@{t2}: Zeitpunkt, an dem Schwellenwert fÃ¼r Gewitter Ã¼berschritten wird (z. B. 30%)
- {g1_next}: Gewitterwahrscheinlichkeit fÃ¼r morgen (nÃ¤chster Tag)
- {r1}@{t3}: HÃ¶chste Regenwahrscheinlichkeit
- {r2}@{t4}: Zeitpunkt, an dem Schwellenwert fÃ¼r Regen Ã¼berschritten wird (z. B. 50%)
- {regen_mm}: Tagesmaximalsumme Regen
- {temp_max}: TageshÃ¶chsttemperatur
- {wind_max}: Maximaler Wind
- {vigilance_warning}: HÃ¶chste Vigilance-Warnung (z.B. "ORANGE Gewitter", "ROT Waldbrand") oder leer

---

## ğŸŒ™ Abendbericht (19:00 Uhr)

### Inhalt
- Gilt fÃ¼r morgen und Ã¼bermorgen
- Zeitraum: jeweils 05:00â€“17:00 CEST
- Geopunkte: alle Punkte der jeweiligen Etappe
- Aggregierung: Maximalwerte Ã¼ber Zeit und Geopunkte

### Format
{EtappeMorgen}â†’{EtappeÃœbermorgen} | Nacht {min_temp}Â°C | Gewitter {g1}%@{t1} ({g2}%@{t2}) | Gewitter +1 {g1_next}% | Regen {r1}%@{t3} ({r2}%@{t4}) {regen_mm}mm | Hitze {temp_max}Â°C | Wind {wind_max}km/h | {vigilance_warning}

### ErlÃ¤uterung
- {EtappeMorgen}: Name der morgigen Etappe
- {min_temp}: Nachttemperatur (Minimum aus Etappenstartpunkt morgen, Zeitraum 22â€“05 Uhr)
- {g1}@{t1}: Gewitterwahrscheinlichkeit morgen
- ({g2}@{t2}): Zeitpunkt mit SchwellenwertÃ¼berschreitung (wenn vorhanden)
- {g1_next}: Gewitterwahrscheinlichkeit fÃ¼r Ã¼bermorgen (Ã¼bernÃ¤chster Tag)
- {r1}@{t3}: Regenwahrscheinlichkeit morgen
- ({r2}@{t4}): Zeitpunkt mit SchwellenwertÃ¼berschreitung (wenn vorhanden)
- {regen_mm}: Regenmenge morgen (Maximalsumme aller Geopunkte)
- {temp_max}: HÃ¶chsttemperatur morgen
- {wind_max}: Windspitze morgen
- {vigilance_warning}: HÃ¶chste Vigilance-Warnung (z.B. "ORANGE Gewitter", "ROT Waldbrand") oder leer

---

## ğŸš¨ Zwischenbericht

### Anlass
Wird nur ausgelÃ¶st durch signifikante Ã„nderung der Gefahrenlage fÃ¼r den laufenden Tag (z. B. neuer Schwellenwert Ã¼berschritten um in config.yaml angegebenen Prozentwert). Er gibt ausschlieÃŸlich die stark geÃ¤nderten Werte aus. Es werden maximal 3 Zwischenberichte pro Tag verschickt. 

### Format
{EtappeHeute} | Update: Gewitter {g2}%@{t2} | Regen {r2}%@{t4} | Hitze {temp_max}Â°C | Wind {wind_max}km/h | {vigilance_warning}